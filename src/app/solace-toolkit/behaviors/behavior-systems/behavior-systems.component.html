<solacetk-model-list [(model)]="model" moduleName="Behavior Systems" modelUri="Behaviors/systems">
    <div class="editor">

        <div class="disp-flex">
            <!-- <mat-form-field class="model-formfield auto-flex">
                <mat-select placeholder="Behavior Type" [(ngModel)]="model.behaviorType">
                    <mat-option *ngFor="let item of behaviorTypes" [value]="item">{{this.behavior[item]}}
                    </mat-option>
                </mat-select>
            </mat-form-field> -->
            <mat-form-field class="auto-flex">
                <input matInput #startState placeholder="Start State" [(ngModel)]="model.startState">
            </mat-form-field>
        </div>

        <mat-divider class="mb-2 mt-2"></mat-divider>

    </div>

    <div class="editor-panels">
        <mat-accordion class="align-start">

            <solacetk-attributes-panel panelName="State Variables Collection" panelColor="mediumvioletred" [(model)]="model.varData"></solacetk-attributes-panel>

            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <mat-icon class="mr-2">schema</mat-icon>
                        Behavior Works
                    </mat-panel-title>
                </mat-expansion-panel-header>

                <ng-template matExpansionPanelContent>

                    <div cdkDropList (cdkDropListDropped)="dropBranches($event)">

                        <mat-card cdkDrag [cdkDragData]="branch" class="auto-flex mb-2" *ngFor="let branch of model.branches" style="background-color: coral;">

                            <mat-card-title-group class="disp-flex">
                                <mat-card-title class="auto-flex">{{branch.name}}</mat-card-title>
                                <mat-chip-list>
                                    <mat-chip *ngFor="let cond of branch.conditions" class="font-small" style="background-color: darkslategrey;">
                                        {{cond.key}} {{operators[cond.operator ?? 0]}} {{cond.data}}
                                    </mat-chip>
                                </mat-chip-list>
                                <h4 class="no-flex mr-2">{{model.branches.indexOf(branch)}}</h4>
                            </mat-card-title-group>

                            <mat-card-content class="disp-flex">
                                <div class="no-flex mr-2 width-33" *ngFor="let state of branch.states">
                                    <mat-chip-list class="mb-2">
                                        <mat-chip *ngFor="let cond of state.conditions" class="font-small" style="background-color: darkslategrey;">
                                            {{cond.key}} {{operators[cond.operator ?? 0]}} {{cond.data}}
                                        </mat-chip>
                                    </mat-chip-list>
                                    <solacetk-animation-editor [(model)]="state.animation.actFrameData"
                                    [showDataPanel]="false" [showFrames]="false" bgColor="coral"></solacetk-animation-editor>
                                    <mat-card-subtitle>{{state.name}}</mat-card-subtitle>
                                    <mat-chip-list>
                                        <mat-chip *ngFor="let data of state.actData" class="font-small" style="background-color: mediumvioletred;">
                                            {{data.key}} {{operators[data.operator ?? 0]}} {{data.data}}
                                        </mat-chip>
                                        <mat-chip *ngFor="let data of state.startData" class="font-small" style="background-color: mediumvioletred;">
                                            {{data.key}} {{operators[data.operator ?? 0]}} {{data.data}}
                                        </mat-chip>
                                        <mat-chip *ngFor="let data of state.endData" class="font-small" style="background-color: mediumvioletred;">
                                            {{data.key}} {{operators[data.operator ?? 0]}} {{data.data}}
                                        </mat-chip>
                                    </mat-chip-list>
                                </div>
                            </mat-card-content>


                            <mat-card-actions>

                            </mat-card-actions>
                        </mat-card>

                    </div>

                </ng-template>


                <mat-action-row>
                    <button mat-button color="primary" (click)="openBranchesSheet()">Add</button>
                </mat-action-row>

            </mat-expansion-panel>

            <!-- <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Events
                    </mat-panel-title>
                </mat-expansion-panel-header>


                <ng-template matExpansionPanelContent>
                    <div *ngIf="model.events">
                        <div *ngFor="let ev of model.events">
                            <mat-card>
                                <mat-card-title>{{ev.name}}</mat-card-title>
                                <mat-card-subtitle>Description: {{ev.description}}</mat-card-subtitle>
                                <mat-card-content>
                                    <div *ngFor="let condition of ev.conditions">
                                        <solacetk-attributes-panel [(model)]="condition.conditions"></solacetk-attributes-panel>
                                    </div>
                                </mat-card-content>
                            </mat-card>
                        </div>
                    </div>

                </ng-template>

                <mat-action-row>
                    <button mat-button color="primary" (click)="openActionsSheet()">Add</button>
                </mat-action-row>
            </mat-expansion-panel> -->

            <solacetk-event-panel class="mb-2" [(model)]="model.events"></solacetk-event-panel>

        </mat-accordion>

    </div>
</solacetk-model-list>