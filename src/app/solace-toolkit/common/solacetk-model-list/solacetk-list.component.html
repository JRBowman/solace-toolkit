<div *ngIf="!modelSelected || !hideEditorHeading" class="disp-flex">
  <img class="no-flex model-formfield icon-sprite" src="../../../assets/soldof/icons/{{moduleIcon}}" alt="Module Icon">
  <h1 class="no-flex align-center mr-5">{{moduleName}}</h1>
  <solacetk-tags *ngIf="!modelSelected" class="auto-flex align-center" [(model)]="tagFilters"
    (tagsChange)="filter($event)" tkHeading="Tags Filter"></solacetk-tags>
</div>


<div class="btn-hover-right" *ngIf="!IsLoading">
  <mat-tab-group [selectedIndex]="tabIndex" (selectedIndexChange)="tabIndex = $event">
    <mat-tab class="no-height" label="List">

      <div class="disp-flex auto-flex mt-2 mb-2" *ngFor='let model of filteredData'>
        <mat-card class="auto-flex">

          <mat-card-title-group class="align-center">
            <div mat-card-avatar class="no-flex align-center">
              <h3 class="mat-card-subtitle font-small">{{filteredData.indexOf(model)}}:</h3>
            </div>
            <div class="no-flex mr-2">
              <mat-card-title class="font-large">{{model.name}}</mat-card-title>
              <mat-card-subtitle>Description: {{model.description}}</mat-card-subtitle>
            </div>
            <solacetk-tags class="auto-flex full-width align-center" [(model)]="model.tags"
              (tagClick)="clickFilter($event)" [canEdit]="false"></solacetk-tags>
            <button id="modelEditBtn" class="no-flex align-center" aria-label="Edit Model" title="Edit Model"
              matTooltip="Edit Model" color="accent" mat-icon-button (click)="LoadModel(model)">
              <mat-icon>edit_square</mat-icon>
            </button>
            <button id="modelDeleteBtn" class="no-flex align-center" aria-label="Delete Model" title="Edit Model"
              matTooltip="Delete Model" color="warn" mat-icon-button (click)="DeleteModel(model)">
              <mat-icon>delete</mat-icon>
            </button>
          </mat-card-title-group>

        </mat-card>
      </div>


    </mat-tab>
      <mat-tab label="Editor">

      <div *ngIf="model" class="character-container mt-2">

        <mat-expansion-panel [expanded]="!collapseCoreEditor">
          <mat-expansion-panel-header>
            <mat-panel-title>
              {{model.name}}
            </mat-panel-title>
            <mat-panel-description>
              Description: {{model.description}}
            </mat-panel-description>
          </mat-expansion-panel-header>

          <div>
            <mat-form-field class="auto-flex full-width">
              <input matInput disabled placeholder="Id" [(ngModel)]="model.id">
            </mat-form-field>

            <solacetk-tags [(model)]="model.tags"></solacetk-tags>

            <mat-form-field class="auto-flex">
              <input matInput placeholder="Name" [(ngModel)]="model.name">
            </mat-form-field>

            <mat-form-field class="auto-flex full-width">
              <textarea matInput #description class="min-height-96 full-width" placeholder="Description"
                [(ngModel)]="model.description"></textarea>
            </mat-form-field>

            <h3>Properties</h3>
            <ng-content select=".editor"></ng-content>
            
          </div>
        </mat-expansion-panel>

        <mat-divider class="mb-2 mt-2"></mat-divider>

          <ng-content select=".editor-panels"></ng-content>


      </div>

      <p *ngIf="!modelSelected">No Model Selected, Select a Model from the List or Create a New Model.</p>
    </mat-tab>
  </mat-tab-group>


  <div class="new-button auto-flex">

    <ng-content select=".editor-buttons"></ng-content>

    <button *ngIf="!modelSelected" mat-fab color="primary" matTooltip="Create New Model"
      class="mat-elevation-z4 btn-hover-right" aria-label="Add new Character Controller" (click)="NewModel()">
      <mat-icon>add</mat-icon>
    </button>

    <button *ngIf="modelSelected && !IsNewModel" mat-fab color="accent" matTooltip="Export Selected Model"
      class="mat-elevation-z4 btn-hover-right" aria-label="Export Model" (click)="ExportModel()">
      <mat-icon>download</mat-icon>
    </button>

    <div *ngIf="tabIndex === 1 && modelSelected">
      <button mat-fab color="primary" matTooltip="Save Current Editor" class="mat-elevation-z4 btn-hover-right"
        aria-label="Save Current Editor Window" (click)="SaveModel()">
        <mat-icon>save</mat-icon>
      </button>

      <button mat-fab color="warn" matTooltip="Close Current Editor" class="mat-elevation-z4 btn-hover-right"
        aria-label="Close Current Editor Window" (click)="CloseModel()">
        <mat-icon>close</mat-icon>
      </button>
    </div>
  </div>

</div>

<div class="loader">
  <mat-spinner *ngIf="IsLoading || IsSaving"></mat-spinner>
</div>